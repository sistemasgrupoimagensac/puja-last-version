"use strict";(self.webpackChunkdocumentacion=self.webpackChunkdocumentacion||[]).push([[6666],{3264:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"tecnica/DT_Iniciar_Sesion","title":"Inicio de Sesi\xf3n","description":"1. Resumen","source":"@site/docs/tecnica/DT_Iniciar_Sesion.md","sourceDirName":"tecnica","slug":"/tecnica/DT_Iniciar_Sesion","permalink":"/documentacion/docs/tecnica/DT_Iniciar_Sesion","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_label":"Inicio de Sesi\xf3n","sidebar_position":3,"title":"Inicio de Sesi\xf3n"},"sidebar":"documentationSidebar","previous":{"title":"Registro con Google","permalink":"/documentacion/docs/tecnica/DT_Registro_Usuario_Google"},"next":{"title":"Inicio de Sesi\xf3n con Google","permalink":"/documentacion/docs/tecnica/DT_Iniciar_Sesion_Google"}}');var r=i(4848),d=i(8453);const o={sidebar_label:"Inicio de Sesi\xf3n",sidebar_position:3,title:"Inicio de Sesi\xf3n"},l="Documento T\xe9cnico: Iniciar Sesi\xf3n",c={},a=[{value:"1. Resumen",id:"1-resumen",level:2},{value:"2. Requisitos Funcionales Relacionados",id:"2-requisitos-funcionales-relacionados",level:2},{value:"3. Base de Datos Relacionada",id:"3-base-de-datos-relacionada",level:2},{value:"Tablas Implicadas",id:"tablas-implicadas",level:3},{value:"Tabla: <code>users</code>",id:"tabla-users",level:3},{value:"Descripci\xf3n Actualizada:",id:"descripci\xf3n-actualizada",level:4},{value:"Tabla: <code>tipos_documento</code>",id:"tabla-tipos_documento",level:4},{value:"Tabla: <code>tipos_usuario</code>",id:"tabla-tipos_usuario",level:4},{value:"Relaci\xf3n de Llaves For\xe1neas:",id:"relaci\xf3n-de-llaves-for\xe1neas",level:4},{value:"Cambios Recientes:",id:"cambios-recientes",level:4},{value:"Relaciones:",id:"relaciones",level:4},{value:"5. APIs y Scripts",id:"5-apis-y-scripts",level:2},{value:"<strong>API de Inicio de Sesi\xf3n</strong>",id:"api-de-inicio-de-sesi\xf3n",level:3},{value:"<strong>Scripts de Frontend</strong>",id:"scripts-de-frontend",level:3},{value:"6. Controladores",id:"6-controladores",level:2},{value:"<strong>M\xe9todo: LoginController@login</strong>",id:"m\xe9todo-logincontrollerlogin",level:3},{value:"<strong>Detalles T\xe9cnicos del C\xf3digo</strong>",id:"detalles-t\xe9cnicos-del-c\xf3digo",level:4},{value:"7. Historial de Cambios",id:"7-historial-de-cambios",level:2}];function t(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"documento-t\xe9cnico-iniciar-sesi\xf3n",children:"Documento T\xe9cnico: Iniciar Sesi\xf3n"})}),"\n",(0,r.jsx)(n.h2,{id:"1-resumen",children:"1. Resumen"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Descripci\xf3n:"}),(0,r.jsx)(n.br,{}),"\n","El inicio de sesi\xf3n permite a los usuarios autenticarse en el sistema utilizando sus credenciales (correo electr\xf3nico y contrase\xf1a). El sistema gestiona distintos perfiles: propietario, corredor y acreedor. Adem\xe1s, se valida el estado del usuario, como los pagos pendientes o el tipo de inicio de sesi\xf3n (manual o externo)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prop\xf3sito:"}),(0,r.jsx)(n.br,{}),"\n","Garantizar un acceso seguro y personalizado a la plataforma, controlando el flujo seg\xfan el tipo de usuario y su estado actual."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-requisitos-funcionales-relacionados",children:"2. Requisitos Funcionales Relacionados"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"ID"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Nombre del Requisito"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Descripci\xf3n"})})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"RF003"})}),(0,r.jsx)(n.td,{children:"Iniciar sesi\xf3n"}),(0,r.jsx)(n.td,{children:"Permitir a los usuarios autenticarse con sus credenciales."})]})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-base-de-datos-relacionada",children:"3. Base de Datos Relacionada"}),"\n",(0,r.jsx)(n.h3,{id:"tablas-implicadas",children:"Tablas Implicadas"}),"\n",(0,r.jsxs)(n.h3,{id:"tabla-users",children:["Tabla: ",(0,r.jsx)(n.code,{children:"users"})]}),"\n",(0,r.jsx)(n.h4,{id:"descripci\xf3n-actualizada",children:"Descripci\xf3n Actualizada:"}),"\n",(0,r.jsxs)(n.p,{children:["La tabla ",(0,r.jsx)(n.code,{children:"users"})," contiene la informaci\xf3n principal de los usuarios de la plataforma. Incluye campos necesarios para la autenticaci\xf3n, datos personales, preferencias de privacidad, y asociaciones con otros modelos relevantes."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Columna"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Tipo"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Descripci\xf3n"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"id"}),(0,r.jsx)(n.td,{children:"BIGINT"}),(0,r.jsx)(n.td,{children:"Identificador \xfanico del usuario."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"tipo_usuario_id"}),(0,r.jsx)(n.td,{children:"BIGINT (FK)"}),(0,r.jsxs)(n.td,{children:["Relaci\xf3n con la tabla ",(0,r.jsx)(n.code,{children:"tipos_usuario"}),", que determina el perfil del usuario."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"not_pay"}),(0,r.jsx)(n.td,{children:"BOOLEAN"}),(0,r.jsx)(n.td,{children:"Indica si el usuario tiene pagos pendientes (0: no, 1: s\xed)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"codigo_unico"}),(0,r.jsx)(n.td,{children:"VARCHAR(200)"}),(0,r.jsx)(n.td,{children:"C\xf3digo \xfanico asociado al usuario, usado para identificaciones espec\xedficas."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"nombres"}),(0,r.jsx)(n.td,{children:"VARCHAR(200)"}),(0,r.jsx)(n.td,{children:"Nombre del usuario."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"apellidos"}),(0,r.jsx)(n.td,{children:"VARCHAR(200)"}),(0,r.jsx)(n.td,{children:"Apellidos del usuario."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"email"}),(0,r.jsx)(n.td,{children:"VARCHAR(150)"}),(0,r.jsx)(n.td,{children:"Correo electr\xf3nico \xfanico para cada usuario."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"password"}),(0,r.jsx)(n.td,{children:"VARCHAR(255)"}),(0,r.jsxs)(n.td,{children:["Contrase\xf1a hash del usuario. Puede ser ",(0,r.jsx)(n.code,{children:"null"})," para usuarios con inicio externo."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"google_id"}),(0,r.jsx)(n.td,{children:"VARCHAR(255)"}),(0,r.jsx)(n.td,{children:"ID de Google para usuarios creados mediante inicio de sesi\xf3n externo."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"tipo_documento_id"}),(0,r.jsx)(n.td,{children:"BIGINT (FK)"}),(0,r.jsxs)(n.td,{children:["Relaci\xf3n con la tabla ",(0,r.jsx)(n.code,{children:"tipos_documento"}),", que define el tipo de documento."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"numero_documento"}),(0,r.jsx)(n.td,{children:"VARCHAR(50)"}),(0,r.jsx)(n.td,{children:"N\xfamero de documento asociado al usuario."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"celular"}),(0,r.jsx)(n.td,{children:"VARCHAR(15)"}),(0,r.jsx)(n.td,{children:"N\xfamero de tel\xe9fono del usuario."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"imagen"}),(0,r.jsx)(n.td,{children:"VARCHAR(250)"}),(0,r.jsx)(n.td,{children:"URL de la imagen de perfil del usuario."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"estado"}),(0,r.jsx)(n.td,{children:"SMALLINT"}),(0,r.jsx)(n.td,{children:"Estado del usuario (1: activo, 0: inactivo)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"acepta_termino_condiciones"}),(0,r.jsx)(n.td,{children:"BOOLEAN"}),(0,r.jsx)(n.td,{children:"Indica si el usuario acept\xf3 los t\xe9rminos y condiciones de uso (1: s\xed, 0: no)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"acepta_confidencialidad"}),(0,r.jsx)(n.td,{children:"BOOLEAN"}),(0,r.jsx)(n.td,{children:"Indica si el usuario acept\xf3 las pol\xedticas de confidencialidad (1: s\xed, 0: no)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"email_verified_at"}),(0,r.jsx)(n.td,{children:"TIMESTAMP"}),(0,r.jsx)(n.td,{children:"Fecha y hora en que el correo fue verificado."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"remember_token"}),(0,r.jsx)(n.td,{children:"VARCHAR(100)"}),(0,r.jsx)(n.td,{children:'Token para la funcionalidad de "recu\xe9rdame".'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"created_at"}),(0,r.jsx)(n.td,{children:"TIMESTAMP"}),(0,r.jsx)(n.td,{children:"Fecha y hora de creaci\xf3n del registro."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"updated_at"}),(0,r.jsx)(n.td,{children:"TIMESTAMP"}),(0,r.jsx)(n.td,{children:"Fecha y hora de la \xfaltima actualizaci\xf3n del registro."})]})]})]}),"\n",(0,r.jsxs)(n.h4,{id:"tabla-tipos_documento",children:["Tabla: ",(0,r.jsx)(n.code,{children:"tipos_documento"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prop\xf3sito:"}),"\r\nLa tabla ",(0,r.jsx)(n.code,{children:"tipos_documento"})," almacena los diferentes tipos de documentos que pueden ser asignados a los usuarios, tales como DNI, pasaporte, carnet de extranjer\xeda, entre otros."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Columna"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Tipo"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Descripci\xf3n"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"id"}),(0,r.jsx)(n.td,{children:"BIGINT"}),(0,r.jsx)(n.td,{children:"Identificador \xfanico del tipo de documento."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"documento"}),(0,r.jsx)(n.td,{children:"VARCHAR(150)"}),(0,r.jsx)(n.td,{children:'Nombre o descripci\xf3n del tipo de documento (e.g., "DNI").'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"estado"}),(0,r.jsx)(n.td,{children:"BOOLEAN"}),(0,r.jsx)(n.td,{children:"Indica si el tipo de documento est\xe1 activo (1: activo, 0: inactivo)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"created_at"}),(0,r.jsx)(n.td,{children:"TIMESTAMP"}),(0,r.jsx)(n.td,{children:"Fecha y hora de creaci\xf3n del registro."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"updated_at"}),(0,r.jsx)(n.td,{children:"TIMESTAMP"}),(0,r.jsx)(n.td,{children:"Fecha y hora de la \xfaltima actualizaci\xf3n del registro."})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h4,{id:"tabla-tipos_usuario",children:["Tabla: ",(0,r.jsx)(n.code,{children:"tipos_usuario"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prop\xf3sito:"}),"\r\nLa tabla ",(0,r.jsx)(n.code,{children:"tipos_usuario"})," define los roles asignables a los usuarios en la plataforma, como propietarios, corredores o acreedores."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Columna"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Tipo"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Descripci\xf3n"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"id"}),(0,r.jsx)(n.td,{children:"BIGINT"}),(0,r.jsx)(n.td,{children:"Identificador \xfanico del tipo de usuario."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"tipo"}),(0,r.jsx)(n.td,{children:"VARCHAR(150)"}),(0,r.jsx)(n.td,{children:'Nombre o descripci\xf3n del tipo de usuario (e.g., "Propietario").'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"estado"}),(0,r.jsx)(n.td,{children:"BOOLEAN"}),(0,r.jsx)(n.td,{children:"Indica si el tipo de usuario est\xe1 activo (1: activo, 0: inactivo)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"created_at"}),(0,r.jsx)(n.td,{children:"TIMESTAMP"}),(0,r.jsx)(n.td,{children:"Fecha y hora de creaci\xf3n del registro."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"updated_at"}),(0,r.jsx)(n.td,{children:"TIMESTAMP"}),(0,r.jsx)(n.td,{children:"Fecha y hora de la \xfaltima actualizaci\xf3n del registro."})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"relaci\xf3n-de-llaves-for\xe1neas",children:"Relaci\xf3n de Llaves For\xe1neas:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"tipo_usuario_id"}),":"]})," Relaciona al usuario con su perfil definido en ",(0,r.jsx)(n.code,{children:"tipos_usuario"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"tipo_documento_id"}),":"]})," Relaciona al usuario con el tipo de documento almacenado en ",(0,r.jsx)(n.code,{children:"tipos_documento"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"cambios-recientes",children:"Cambios Recientes:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Incorporaci\xf3n del Campo ",(0,r.jsx)(n.code,{children:"not_pay"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Prop\xf3sito: Indicar si el usuario tiene pagos pendientes."}),"\n",(0,r.jsxs)(n.li,{children:["Tipo: ",(0,r.jsx)(n.code,{children:"BOOLEAN"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Valor por defecto: ",(0,r.jsx)(n.code,{children:"0"})," (sin pagos pendientes)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Detalles de Contrase\xf1a y Google ID:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["La columna ",(0,r.jsx)(n.code,{children:"password"})," puede ser ",(0,r.jsx)(n.code,{children:"null"})," para usuarios creados mediante inicio de sesi\xf3n externo."]}),"\n",(0,r.jsxs)(n.li,{children:["Se agreg\xf3 el campo ",(0,r.jsx)(n.code,{children:"google_id"})," para almacenar el identificador del usuario en Google."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"relaciones",children:"Relaciones:"}),"\n",(0,r.jsx)(n.mermaid,{value:'erDiagram\r\n    users {\r\n        BIGINT id PK\r\n        BIGINT tipo_usuario_id FK\r\n        BIGINT tipo_documento_id FK\r\n        VARCHAR codigo_unico\r\n        VARCHAR nombres\r\n        VARCHAR apellidos\r\n        VARCHAR email\r\n        VARCHAR password\r\n        VARCHAR google_id\r\n        VARCHAR numero_documento\r\n        VARCHAR celular\r\n        VARCHAR imagen\r\n        SMALLINT estado\r\n        BOOLEAN acepta_termino_condiciones\r\n        BOOLEAN acepta_confidencialidad\r\n        TIMESTAMP email_verified_at\r\n        TIMESTAMP created_at\r\n        TIMESTAMP updated_at\r\n    }\r\n\r\n    tipos_documento {\r\n        BIGINT id PK\r\n        VARCHAR documento\r\n        BOOLEAN estado\r\n        TIMESTAMP created_at\r\n        TIMESTAMP updated_at\r\n    }\r\n\r\n    tipos_usuario {\r\n        BIGINT id PK\r\n        VARCHAR tipo\r\n        BOOLEAN estado\r\n        TIMESTAMP created_at\r\n        TIMESTAMP updated_at\r\n    }\r\n\r\n    users ||--o{ tipos_usuario : "N:1"\r\n    users ||--o{ tipos_documento : "N:1"\r\n'}),"\n",(0,r.jsx)(n.p,{children:"Esta estructura relacional permite que cada usuario est\xe9 asociado a un tipo de documento y un tipo de usuario espec\xedfico, proporcionando flexibilidad y organizaci\xf3n en la gesti\xf3n de usuarios."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-apis-y-scripts",children:"5. APIs y Scripts"}),"\n",(0,r.jsx)(n.h3,{id:"api-de-inicio-de-sesi\xf3n",children:(0,r.jsx)(n.strong,{children:"API de Inicio de Sesi\xf3n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /login"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"M\xe9todo:"})," ",(0,r.jsx)(n.code,{children:"LoginController@login"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Prop\xf3sito:"}),(0,r.jsx)(n.br,{}),"\n","Procesar las credenciales ingresadas por el usuario, validar los datos y autenticar al usuario en el sistema."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scripts-de-frontend",children:(0,r.jsx)(n.strong,{children:"Scripts de Frontend"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Formulario de inicio de sesi\xf3n:"}),(0,r.jsx)(n.br,{}),"\n","El formulario env\xeda las credenciales mediante una solicitud ",(0,r.jsx)(n.code,{children:"POST"})," al backend, incluyendo:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"correo"}),": Correo electr\xf3nico del usuario."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"contrase\xf1a"}),": Contrase\xf1a del usuario."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validaci\xf3n y Redirecci\xf3n:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si la autenticaci\xf3n es exitosa, el usuario es redirigido a su panel correspondiente."}),"\n",(0,r.jsx)(n.li,{children:"Si hay un error (como credenciales incorrectas), el formulario muestra un mensaje de error."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-controladores",children:"6. Controladores"}),"\n",(0,r.jsx)(n.h3,{id:"m\xe9todo-logincontrollerlogin",children:(0,r.jsx)(n.strong,{children:"M\xe9todo: LoginController@login"})}),"\n",(0,r.jsx)(n.p,{children:"Este m\xe9todo realiza la autenticaci\xf3n del usuario mediante varios pasos:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validaci\xf3n Inicial:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Se valida que los campos ",(0,r.jsx)(n.code,{children:"user_type"}),", ",(0,r.jsx)(n.code,{children:"correo"}),", y ",(0,r.jsx)(n.code,{children:"contrase\xf1a"})," sean proporcionados correctamente."]}),"\n",(0,r.jsx)(n.li,{children:"Si la validaci\xf3n falla, se devuelve un error con los detalles."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B\xfasqueda del Usuario:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Se busca un registro en la tabla ",(0,r.jsx)(n.code,{children:"users"})," que coincida con el correo proporcionado."]}),"\n",(0,r.jsx)(n.li,{children:"Si no existe un usuario con ese correo, se devuelve un error indicando que el correo no est\xe1 registrado."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validaci\xf3n de Contrase\xf1a:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Si el campo ",(0,r.jsx)(n.code,{children:"password"})," del usuario est\xe1 vac\xedo o nulo, se asume que el usuario fue creado mediante un inicio de sesi\xf3n externo (como Google)."]}),"\n",(0,r.jsx)(n.li,{children:"Si el hash de la contrase\xf1a no coincide con la ingresada, se devuelve un error indicando que la contrase\xf1a es incorrecta."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validaci\xf3n de Tipo de Usuario y Estado:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:['Si el usuario pertenece al tipo "acreedor" (',(0,r.jsx)(n.code,{children:"tipo_usuario_id == 5"}),"), se realiza una validaci\xf3n adicional para verificar su estado de pago."]}),"\n",(0,r.jsx)(n.li,{children:"Si el usuario tiene pagos pendientes, se redirige al flujo de pagos y se almacenan los datos relevantes en la sesi\xf3n."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Autenticaci\xf3n Exitosa:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Si todas las validaciones son correctas, el m\xe9todo autentica al usuario utilizando ",(0,r.jsx)(n.code,{children:"Auth::login($user)"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Finalmente, se redirige al panel correspondiente del usuario."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"detalles-t\xe9cnicos-del-c\xf3digo",children:(0,r.jsx)(n.strong,{children:"Detalles T\xe9cnicos del C\xf3digo"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validaci\xf3n del Formulario"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$validator = Validator::make($request->all(), [\r\n    'user_type' => 'required|string',\r\n    'correo' => 'required|email',\r\n    'contrase\xf1a' => 'required',\r\n]);\r\nif ($validator->fails()) {\r\n    return response()->json([\r\n        'message' => 'Errores de validaci\xf3n',\r\n        'errors' => $validator->errors()\r\n    ], 422);\r\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Este bloque asegura que los datos ingresados cumplan con los requisitos m\xednimos."}),"\n",(0,r.jsx)(n.li,{children:"Si los datos no son v\xe1lidos, el m\xe9todo detiene su ejecuci\xf3n y devuelve errores al frontend."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validaci\xf3n de Contrase\xf1a"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"if (!Hash::check($request->input('contrase\xf1a'), $user->password)) {\r\n    return response()->json([\r\n        'message' => 'La contrase\xf1a es incorrecta.',\r\n        'errors' => [\r\n            'contrase\xf1a' => ['La contrase\xf1a es incorrecta.']\r\n        ]\r\n    ], 422);\r\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Se utiliza ",(0,r.jsx)(n.code,{children:"Hash::check"})," para comparar la contrase\xf1a ingresada con el hash almacenado en la base de datos."]}),"\n",(0,r.jsx)(n.li,{children:"Esto garantiza que las contrase\xf1as no se almacenen en texto plano."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Manejo de Usuarios Acreedores"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"if ($user->tipo_usuario_id == 5) {\r\n    $proyectoCliente = ProyectoCliente::join('proyecto_planes_activos', 'proyecto_clientes.id', '=', 'proyecto_planes_activos.proyecto_cliente_id')\r\n        ->where('proyecto_clientes.user_id', $user->id)\r\n        ->where('proyecto_planes_activos.fecha_inicio', '<=', Carbon::now())\r\n        ->where('proyecto_planes_activos.fecha_fin', '>=', Carbon::now())\r\n        ->orderBy('proyecto_planes_activos.fecha_inicio', 'desc')\r\n        ->first();\r\n    if (!$proyectoCliente->al_dia) {\r\n        session([...]); // Guardar datos en sesi\xf3n\r\n        return response()->json([...], 200);\r\n    }\r\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'Este bloque verifica si un usuario de tipo "acreedor" tiene pagos pendientes. Si es as\xed, se redirige al flujo de pagos.'}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Inicio de Sesi\xf3n y Redirecci\xf3n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"Auth::login($user);\r\nreturn response()->json([\r\n    'message' => 'Inicio de sesi\xf3n exitoso.',\r\n    'redirect' => redirect()->intended(route('panel.mis-avisos'))->getTargetUrl(),\r\n]);\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["El m\xe9todo ",(0,r.jsx)(n.code,{children:"Auth::login"})," autentica al usuario."]}),"\n",(0,r.jsx)(n.li,{children:"Luego, se redirige al panel de administraci\xf3n o la p\xe1gina deseada."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-historial-de-cambios",children:"7. Historial de Cambios"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Versi\xf3n"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Fecha"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Cambios Realizados"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Autor"})})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"v1.0"}),(0,r.jsx)(n.td,{children:"12/12/2024"}),(0,r.jsx)(n.td,{children:"Documento t\xe9cnico inicial creado"}),(0,r.jsx)(n.td,{children:"Walker Alfaro"})]})})]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const r={},d=s.createContext(r);function o(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);